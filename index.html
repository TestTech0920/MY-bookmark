<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Mani's Bookmark Vault</title>
  <meta name="description" content="Personal bookmark manager with clipboard capture, GitHub sync, share target, and offline-ready storage.">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%230f172a'/><path d='M25 25h50v50L50 60 25 75Z' fill='%23ffca3a'/></svg>">
  <meta name="theme-color" content="#ffca3a">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%230f172a'/><path d='M25 25h50v50L50 60 25 75Z' fill='%23ffca3a'/></svg>">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    :root {
      color-scheme: light;
      --safe-area-top: env(safe-area-inset-top, 0px);
      --safe-area-bottom: env(safe-area-inset-bottom, 0px);
      --safe-area-left: env(safe-area-inset-left, 0px);
      --safe-area-right: env(safe-area-inset-right, 0px);
    }
    
    * {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    
    html, body {
      overscroll-behavior: none;
      -webkit-overflow-scrolling: touch;
    }
    
    body {
      min-height: 100vh;
      min-height: 100dvh;
      background: radial-gradient(circle at top, #fff7d6 0%, #ffe7c6 35%, #f7f0ff 70%, #dbe8ff 100%);
      transition: background 0.5s ease, color 0.5s ease;
      color: #0f172a;
      padding-bottom: calc(80px + var(--safe-area-bottom));
      padding-top: var(--safe-area-top);
    }
    
    body[data-theme="midnight"] {
      background: radial-gradient(circle at top, #090915 0%, #111327 45%, #0b132b 100%);
      color: #f5f7ff;
    }
    
    body[data-theme="neon"] {
      background: radial-gradient(circle at top, #030014 0%, #10002b 40%, #240046 70%, #36005c 100%);
      color: #f3f6ff;
    }
    
    body[data-theme="glass"] {
      background: linear-gradient(135deg, #e8f0ff 0%, #fef6ff 35%, #e9fffb 65%, #fefde1 100%);
      color: #0f172a;
    }
    
    body.modal-open {
      overflow: hidden;
      position: fixed;
      width: 100%;
    }
    
    /* Mobile-optimized inputs */
    input, select, textarea {
      color: inherit;
      background: rgba(255, 255, 255, 0.95);
      font-size: 16px !important; /* Prevents iOS zoom */
      border-radius: 16px;
      padding: 14px 16px;
    }
    
    input::placeholder, textarea::placeholder {
      color: #94a3b8;
    }
    
    body[data-theme="midnight"] input,
    body[data-theme="midnight"] select,
    body[data-theme="midnight"] textarea,
    body[data-theme="neon"] input,
    body[data-theme="neon"] select,
    body[data-theme="neon"] textarea {
      background: rgba(8, 10, 24, 0.65);
      border-color: rgba(255, 255, 255, 0.15);
      color: #f5f7ff;
    }
    
    /* Glass panels */
    .glass-panel {
      background: rgba(255, 255, 255, 0.75);
      border: 1px solid rgba(255, 255, 255, 0.35);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: 0 10px 40px rgba(15, 23, 42, 0.1);
    }
    
    body[data-theme="midnight"] .glass-panel {
      background: rgba(7, 10, 23, 0.85);
      border-color: rgba(255, 255, 255, 0.08);
    }
    
    body[data-theme="neon"] .glass-panel {
      background: rgba(8, 9, 26, 0.8);
      border-color: rgba(80, 255, 218, 0.3);
    }
    
    body[data-theme="glass"] .glass-panel {
      background: rgba(255, 255, 255, 0.6);
      border-color: rgba(15, 23, 42, 0.08);
    }
    
    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: calc(70px + var(--safe-area-bottom));
      padding-bottom: var(--safe-area-bottom);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 1px solid rgba(15, 23, 42, 0.1);
      display: flex;
      justify-content: space-around;
      align-items: flex-start;
      padding-top: 8px;
      z-index: 100;
    }
    
    body[data-theme="midnight"] .bottom-nav,
    body[data-theme="neon"] .bottom-nav {
      background: rgba(7, 10, 23, 0.95);
      border-color: rgba(255, 255, 255, 0.1);
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 16px;
      border-radius: 16px;
      transition: all 0.2s ease;
      min-width: 64px;
    }
    
    .nav-item.active {
      background: rgba(15, 23, 42, 0.08);
    }
    
    body[data-theme="midnight"] .nav-item.active,
    body[data-theme="neon"] .nav-item.active {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .nav-item svg {
      width: 24px;
      height: 24px;
    }
    
    .nav-item span {
      font-size: 10px;
      font-weight: 500;
    }
    
    /* Floating Action Button */
    .fab {
      position: fixed;
      bottom: calc(90px + var(--safe-area-bottom));
      right: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffca3a 0%, #ff9500 100%);
      color: #0f172a;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 30px rgba(255, 202, 58, 0.4);
      z-index: 99;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .fab:active {
      transform: scale(0.92);
    }
    
    .fab svg {
      width: 28px;
      height: 28px;
    }
    
    /* Bookmark Cards - Swipeable */
    .bookmark-card {
      border-radius: 20px;
      border: 1px solid rgba(15, 23, 42, 0.08);
      padding: 16px;
      background: rgba(255, 255, 255, 0.95);
      position: relative;
      overflow: hidden;
      transition: transform 0.2s ease;
      touch-action: pan-y pinch-zoom;
    }
    
    body[data-theme="midnight"] .bookmark-card,
    body[data-theme="neon"] .bookmark-card {
      border-color: rgba(255, 255, 255, 0.06);
      background: rgba(9, 13, 29, 0.95);
    }
    
    .bookmark-card.swiping {
      transition: none;
    }
    
    .swipe-actions {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }
    
    .swipe-action-left {
      left: 0;
      background: linear-gradient(90deg, #10b981 0%, #10b981 80%, transparent 100%);
      color: white;
      padding-left: 16px;
    }
    
    .swipe-action-right {
      right: 0;
      background: linear-gradient(-90deg, #ef4444 0%, #ef4444 80%, transparent 100%);
      color: white;
      padding-right: 16px;
    }
    
    .bookmark-content {
      position: relative;
      background: inherit;
      z-index: 1;
    }
    
    .bookmark-thumb {
      width: 72px;
      height: 72px;
      border-radius: 16px;
      object-fit: cover;
      background: #e8ecf5;
      border: 1px solid rgba(15, 23, 42, 0.08);
      flex-shrink: 0;
    }
    
    body[data-theme="midnight"] .bookmark-thumb,
    body[data-theme="neon"] .bookmark-thumb {
      background: #1f2940;
      border-color: rgba(255, 255, 255, 0.05);
    }
    
    /* Pull to Refresh */
    .pull-indicator {
      position: fixed;
      top: var(--safe-area-top);
      left: 50%;
      transform: translateX(-50%) translateY(-60px);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      transition: transform 0.2s ease;
      z-index: 200;
    }
    
    .pull-indicator.visible {
      transform: translateX(-50%) translateY(20px);
    }
    
    .pull-indicator.refreshing svg {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    /* Quick Actions Sheet */
    .action-sheet {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 150;
      display: flex;
      align-items: flex-end;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .action-sheet.visible {
      opacity: 1;
      visibility: visible;
    }
    
    .action-sheet-content {
      width: 100%;
      background: rgba(255, 255, 255, 0.98);
      border-radius: 24px 24px 0 0;
      padding: 12px 20px calc(20px + var(--safe-area-bottom));
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }
    
    .action-sheet.visible .action-sheet-content {
      transform: translateY(0);
    }
    
    body[data-theme="midnight"] .action-sheet-content,
    body[data-theme="neon"] .action-sheet-content {
      background: rgba(15, 20, 40, 0.98);
    }
    
    .action-sheet-handle {
      width: 36px;
      height: 5px;
      background: rgba(15, 23, 42, 0.2);
      border-radius: 999px;
      margin: 0 auto 16px;
    }
    
    body[data-theme="midnight"] .action-sheet-handle,
    body[data-theme="neon"] .action-sheet-handle {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .action-sheet-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 500;
      width: 100%;
      text-align: left;
      transition: background 0.2s ease;
    }
    
    .action-sheet-item:active {
      background: rgba(15, 23, 42, 0.08);
    }
    
    body[data-theme="midnight"] .action-sheet-item:active,
    body[data-theme="neon"] .action-sheet-item:active {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .action-sheet-item svg {
      width: 24px;
      height: 24px;
      opacity: 0.7;
    }
    
    .action-sheet-item.destructive {
      color: #ef4444;
    }
    
    /* Search Bar - Sticky */
    .search-container {
      position: sticky;
      top: 0;
      z-index: 50;
      padding: 12px 16px;
      background: inherit;
    }
    
    .search-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(15, 23, 42, 0.1);
      border-radius: 16px;
      padding: 12px 16px;
    }
    
    body[data-theme="midnight"] .search-bar,
    body[data-theme="neon"] .search-bar {
      background: rgba(20, 25, 45, 0.9);
      border-color: rgba(255, 255, 255, 0.1);
    }
    
    .search-bar input {
      flex: 1;
      background: transparent;
      border: none;
      padding: 0;
      font-size: 16px;
    }
    
    .search-bar input:focus {
      outline: none;
    }
    
    /* Platform Chips - Horizontal Scroll */
    .platform-scroll {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding: 4px 16px 12px;
      margin: 0 -16px;
      scrollbar-width: none;
      -ms-overflow-style: none;
      scroll-snap-type: x mandatory;
    }
    
    .platform-scroll::-webkit-scrollbar {
      display: none;
    }
    
    .platform-chip {
      flex-shrink: 0;
      padding: 10px 18px;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(15, 23, 42, 0.08);
      font-size: 14px;
      font-weight: 500;
      scroll-snap-align: start;
      transition: all 0.2s ease;
    }
    
    .platform-chip.active {
      background: #0f172a;
      color: white;
      border-color: #0f172a;
    }
    
    body[data-theme="midnight"] .platform-chip,
    body[data-theme="neon"] .platform-chip {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.1);
      color: #e2e8f0;
    }
    
    body[data-theme="midnight"] .platform-chip.active,
    body[data-theme="neon"] .platform-chip.active {
      background: #ffca3a;
      color: #0f172a;
      border-color: #ffca3a;
    }
    
    /* Folder Pills */
    .folder-scroll {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding: 8px 16px;
      margin: 0 -16px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    
    .folder-scroll::-webkit-scrollbar {
      display: none;
    }
    
    .folder-pill {
      flex-shrink: 0;
      padding: 8px 16px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.06);
      font-size: 13px;
      font-weight: 500;
      white-space: nowrap;
    }
    
    .folder-pill.active {
      background: #0f172a;
      color: white;
    }
    
    body[data-theme="midnight"] .folder-pill,
    body[data-theme="neon"] .folder-pill {
      background: rgba(255, 255, 255, 0.08);
      color: #e2e8f0;
    }
    
    body[data-theme="midnight"] .folder-pill.active,
    body[data-theme="neon"] .folder-pill.active {
      background: #ffca3a;
      color: #0f172a;
    }
    
    /* Tab Bar */
    .tab-bar {
      display: flex;
      background: rgba(15, 23, 42, 0.06);
      border-radius: 14px;
      padding: 4px;
      margin: 0 16px;
    }
    
    body[data-theme="midnight"] .tab-bar,
    body[data-theme="neon"] .tab-bar {
      background: rgba(255, 255, 255, 0.06);
    }
    
    .tab-item {
      flex: 1;
      padding: 10px 8px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      text-align: center;
      transition: all 0.2s ease;
    }
    
    .tab-item.active {
      background: white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    body[data-theme="midnight"] .tab-item.active,
    body[data-theme="neon"] .tab-item.active {
      background: rgba(255, 255, 255, 0.15);
      box-shadow: none;
    }
    
    /* Modal - Full Screen on Mobile */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 200;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-content {
      position: fixed;
      inset: 0;
      background: white;
      z-index: 201;
      transform: translateY(100%);
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
      padding-top: var(--safe-area-top);
      padding-bottom: var(--safe-area-bottom);
    }
    
    .modal-overlay.visible .modal-content {
      transform: translateY(0);
    }
    
    body[data-theme="midnight"] .modal-content,
    body[data-theme="neon"] .modal-content {
      background: #0b0f1a;
    }
    
    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.1);
    }
    
    body[data-theme="midnight"] .modal-header,
    body[data-theme="neon"] .modal-header {
      border-color: rgba(255, 255, 255, 0.1);
    }
    
    .modal-body {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
    }
    
    /* Toast - Mobile Optimized */
    .toast {
      position: fixed;
      bottom: calc(100px + var(--safe-area-bottom));
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      padding: 14px 24px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      color: white;
      font-size: 15px;
      font-weight: 500;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 300;
      max-width: calc(100% - 40px);
      text-align: center;
    }
    
    body[data-theme="midnight"] .toast,
    body[data-theme="neon"] .toast {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .toast.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    
    /* Empty State */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }
    
    .empty-state svg {
      width: 80px;
      height: 80px;
      opacity: 0.3;
      margin-bottom: 20px;
    }
    
    .empty-state h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    
    .empty-state p {
      font-size: 14px;
      opacity: 0.6;
      max-width: 260px;
    }
    
    /* Quick Stats Bar */
    .stats-bar {
      display: flex;
      gap: 12px;
      padding: 12px 16px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    
    .stats-bar::-webkit-scrollbar {
      display: none;
    }
    
    .stat-card {
      flex-shrink: 0;
      padding: 16px 20px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(15, 23, 42, 0.08);
      min-width: 120px;
    }
    
    body[data-theme="midnight"] .stat-card,
    body[data-theme="neon"] .stat-card {
      background: rgba(255, 255, 255, 0.06);
      border-color: rgba(255, 255, 255, 0.08);
    }
    
    .stat-value {
      font-size: 28px;
      font-weight: 700;
    }
    
    .stat-label {
      font-size: 12px;
      opacity: 0.6;
      margin-top: 4px;
    }
    
    /* Skeleton Loading */
    .skeleton {
      background: linear-gradient(90deg, 
        rgba(15, 23, 42, 0.08) 0%, 
        rgba(15, 23, 42, 0.15) 50%, 
        rgba(15, 23, 42, 0.08) 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: 12px;
    }
    
    body[data-theme="midnight"] .skeleton,
    body[data-theme="neon"] .skeleton {
      background: linear-gradient(90deg, 
        rgba(255, 255, 255, 0.05) 0%, 
        rgba(255, 255, 255, 0.1) 50%, 
        rgba(255, 255, 255, 0.05) 100%);
      background-size: 200% 100%;
    }
    
    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    /* Section Headers */
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 16px 12px;
    }
    
    .section-title {
      font-size: 20px;
      font-weight: 700;
    }
    
    .section-action {
      font-size: 14px;
      font-weight: 600;
      color: #3b82f6;
    }
    
    /* Badges */
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 500;
      background: rgba(15, 23, 42, 0.08);
    }
    
    body[data-theme="midnight"] .badge,
    body[data-theme="neon"] .badge {
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* Settings List */
    .settings-list {
      background: rgba(255, 255, 255, 0.8);
      border-radius: 20px;
      overflow: hidden;
      margin: 0 16px;
    }
    
    body[data-theme="midnight"] .settings-list,
    body[data-theme="neon"] .settings-list {
      background: rgba(255, 255, 255, 0.06);
    }
    
    .settings-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.08);
    }
    
    body[data-theme="midnight"] .settings-item,
    body[data-theme="neon"] .settings-item {
      border-color: rgba(255, 255, 255, 0.08);
    }
    
    .settings-item:last-child {
      border-bottom: none;
    }
    
    .settings-item-left {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    
    .settings-item-icon {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .settings-item-icon svg {
      width: 20px;
      height: 20px;
    }
    
    /* Toggle Switch */
    .toggle-switch {
      position: relative;
      width: 52px;
      height: 32px;
      background: rgba(15, 23, 42, 0.2);
      border-radius: 999px;
      transition: background 0.2s ease;
    }
    
    .toggle-switch.active {
      background: #10b981;
    }
    
    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 28px;
      height: 28px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease;
    }
    
    .toggle-switch.active::after {
      transform: translateX(20px);
    }
    
    /* Clipboard Preview Card */
    .clipboard-preview {
      background: rgba(15, 23, 42, 0.04);
      border: 2px dashed rgba(15, 23, 42, 0.15);
      border-radius: 16px;
      padding: 20px;
      margin: 16px;
    }
    
    body[data-theme="midnight"] .clipboard-preview,
    body[data-theme="neon"] .clipboard-preview {
      background: rgba(255, 255, 255, 0.04);
      border-color: rgba(255, 255, 255, 0.15);
    }
    
    .clipboard-preview-text {
      font-size: 14px;
      line-height: 1.6;
      max-height: 120px;
      overflow: hidden;
      word-break: break-word;
    }
    
    /* Long press menu */
    .context-menu {
      position: fixed;
      background: rgba(255, 255, 255, 0.98);
      border-radius: 16px;
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.25);
      padding: 8px;
      min-width: 200px;
      z-index: 250;
      opacity: 0;
      visibility: hidden;
      transform: scale(0.9);
      transition: all 0.15s ease;
    }
    
    .context-menu.visible {
      opacity: 1;
      visibility: visible;
      transform: scale(1);
    }
    
    body[data-theme="midnight"] .context-menu,
    body[data-theme="neon"] .context-menu {
      background: rgba(20, 25, 45, 0.98);
    }
    
    .context-menu-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 10px;
      font-size: 15px;
      width: 100%;
      text-align: left;
    }
    
    .context-menu-item:active {
      background: rgba(15, 23, 42, 0.08);
    }
    
    body[data-theme="midnight"] .context-menu-item:active,
    body[data-theme="neon"] .context-menu-item:active {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .context-menu-item svg {
      width: 20px;
      height: 20px;
      opacity: 0.6;
    }
    
    .context-menu-divider {
      height: 1px;
      background: rgba(15, 23, 42, 0.1);
      margin: 8px 0;
    }
    
    body[data-theme="midnight"] .context-menu-divider,
    body[data-theme="neon"] .context-menu-divider {
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* View sections */
    .view-section {
      display: none;
    }
    
    .view-section.active {
      display: block;
    }
    
    /* Scrollbar hiding for all horizontal scrolls */
    .hide-scrollbar {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    
    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }
    
    /* Line clamp utilities */
    .line-clamp-1 {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    /* Haptic feedback visual */
    .haptic-press {
      animation: hapticPulse 0.15s ease;
    }
    
    @keyframes hapticPulse {
      0% { transform: scale(1); }
      50% { transform: scale(0.97); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body data-theme="sunrise">
  <!-- Pull to Refresh Indicator -->
  <div id="pullIndicator" class="pull-indicator">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
    </svg>
  </div>

  <!-- Main App Container -->
  <div id="appContainer">
    <!-- Home View -->
    <section id="homeView" class="view-section active">
      <!-- Header -->
      <header class="p-4 pb-2">
        <div class="flex items-center justify-between mb-3">
          <div>
            <h1 class="text-2xl font-bold">Bookmarks</h1>
            <p class="text-sm opacity-60" id="bookmarkCountLabel">0 items saved</p>
          </div>
          <button id="headerSettingsBtn" class="w-10 h-10 rounded-full flex items-center justify-center bg-black/5">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
            </svg>
          </button>
        </div>
        
        <!-- Search Bar -->
        <div class="search-bar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.5">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
          <input type="search" id="searchInput" placeholder="Search bookmarks..." autocomplete="off">
          <button id="clearSearchBtn" class="hidden">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.5">
              <circle cx="12" cy="12" r="10"/>
              <path d="M15 9l-6 6M9 9l6 6"/>
            </svg>
          </button>
        </div>
      </header>

      <!-- Quick Stats -->
      <div class="stats-bar hide-scrollbar" id="statsBar">
        <div class="stat-card">
          <div class="stat-value" id="statTotal">0</div>
          <div class="stat-label">Total</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statToday">0</div>
          <div class="stat-label">Today</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statWeek">0</div>
          <div class="stat-label">This Week</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statFolders">0</div>
          <div class="stat-label">Folders</div>
        </div>
      </div>

      <!-- Platform Filter -->
      <div class="platform-scroll hide-scrollbar" id="platformRail"></div>

      <!-- Folder Pills -->
      <div class="folder-scroll hide-scrollbar" id="folderRail"></div>

      <!-- Content Tabs -->
      <div class="tab-bar" id="contentTabs">
        <button class="tab-item active" data-tab="bookmarks">Bookmarks</button>
        <button class="tab-item" data-tab="snippets">Snippets</button>
        <button class="tab-item" data-tab="images">Images</button>
      </div>

      <!-- Bookmark List -->
      <div id="bookmarkList" class="p-4 space-y-3"></div>
      
      <!-- Snippet List -->
      <div id="snippetList" class="p-4 space-y-3 hidden"></div>
      
      <!-- Image Grid -->
      <div id="imageGrid" class="p-4 grid grid-cols-2 gap-3 hidden"></div>

      <!-- Empty State -->
      <div id="emptyState" class="empty-state hidden">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"/>
        </svg>
        <h3>No bookmarks yet</h3>
        <p>Tap the + button to save your first bookmark</p>
      </div>

      <!-- Load More -->
      <div id="loadMoreContainer" class="p-4 text-center hidden">
        <button id="loadMoreBtn" class="px-6 py-3 rounded-full bg-black/5 font-medium">
          Load More
        </button>
      </div>
    </section>

    <!-- Add/Edit View -->
    <div id="addModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <button id="cancelAddBtn" class="text-base font-medium">Cancel</button>
          <h2 class="font-semibold" id="modalTitle">Add Bookmark</h2>
          <button id="saveBookmarkBtn" class="text-base font-semibold text-blue-500">Save</button>
        </div>
        <div class="modal-body">
          <form id="bookmarkForm" class="space-y-4">
            <!-- URL Input -->
            <div>
              <label class="block text-sm font-medium mb-2 opacity-70">URL</label>
              <input type="url" name="url" id="urlInput" placeholder="https://example.com" 
                     class="w-full border border-slate-200">
            </div>

            <!-- Title -->
            <div>
              <label class="block text-sm font-medium mb-2 opacity-70">Title</label>
              <input type="text" name="title" placeholder="Auto-detected from URL" 
                     class="w-full border border-slate-200">
            </div>

            <!-- Platform & Folder Row -->
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label class="block text-sm font-medium mb-2 opacity-70">Platform</label>
                <select name="platform" class="w-full border border-slate-200">
                  <option>YouTube</option>
                  <option>Article</option>
                  <option>Podcast</option>
                  <option>Tweet</option>
                  <option>Custom</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2 opacity-70">Folder</label>
                <input type="text" name="folder" list="folderDatalist" placeholder="e.g. AI" value="AI"
                       class="w-full border border-slate-200">
                <datalist id="folderDatalist"></datalist>
              </div>
            </div>

            <!-- Tags -->
            <div>
              <label class="block text-sm font-medium mb-2 opacity-70">Tags</label>
              <input type="text" name="tags" placeholder="comma, separated, tags" 
                     class="w-full border border-slate-200">
            </div>

            <!-- Notes -->
            <div>
              <label class="block text-sm font-medium mb-2 opacity-70">Notes</label>
              <textarea name="notes" rows="3" placeholder="Add your notes here..." 
                        class="w-full border border-slate-200 resize-none"></textarea>
            </div>

            <!-- Text Snippet Section -->
            <div class="pt-4 border-t border-slate-200">
              <h3 class="font-semibold mb-3">Text Snippet</h3>
              <div class="space-y-3">
                <input type="text" name="textTitle" placeholder="Snippet title" 
                       class="w-full border border-slate-200">
                <textarea name="textSnippet" rows="3" placeholder="Paste text content..." 
                          class="w-full border border-slate-200 resize-none"></textarea>
              </div>
            </div>

            <!-- Image Section -->
            <div class="pt-4 border-t border-slate-200">
              <h3 class="font-semibold mb-3">Reference Image</h3>
              <div class="space-y-3">
                <input type="text" name="imageTitle" placeholder="Image title" 
                       class="w-full border border-slate-200">
                <input type="url" name="imageUrl" placeholder="Image URL" 
                       class="w-full border border-slate-200">
                <div class="relative">
                  <input type="file" name="imageFile" accept="image/*" id="imageFileInput"
                         class="absolute inset-0 opacity-0 cursor-pointer">
                  <div class="border-2 border-dashed border-slate-200 rounded-2xl p-8 text-center">
                    <svg class="w-8 h-8 mx-auto mb-2 opacity-40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                      <circle cx="8.5" cy="8.5" r="1.5"/>
                      <polyline points="21 15 16 10 5 21"/>
                    </svg>
                    <p class="text-sm opacity-60">Tap to upload image</p>
                  </div>
                </div>
                <div id="imagePreview" class="hidden">
                  <img src="" alt="Preview" class="w-full h-40 object-cover rounded-2xl">
                  <button type="button" id="removeImageBtn" class="mt-2 text-sm text-red-500">Remove image</button>
                </div>
              </div>
            </div>

            <!-- Reminder -->
            <div class="pt-4 border-t border-slate-200">
              <h3 class="font-semibold mb-3">Reminder</h3>
              <input type="datetime-local" name="reminder" class="w-full border border-slate-200">
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Settings View -->
    <section id="settingsView" class="view-section">
      <header class="p-4">
        <div class="flex items-center gap-4">
          <button id="backFromSettings" class="w-10 h-10 rounded-full flex items-center justify-center bg-black/5">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <h1 class="text-2xl font-bold">Settings</h1>
        </div>
      </header>

      <div class="space-y-6 pb-8">
        <!-- Appearance -->
        <div>
          <div class="section-header">
            <h2 class="section-title">Appearance</h2>
          </div>
          <div class="settings-list">
            <div class="settings-item">
              <div class="settings-item-left">
                <div class="settings-item-icon bg-purple-100">
                  <svg viewBox="0 0 24 24" fill="none" stroke="#9333ea" stroke-width="2">
                    <circle cx="12" cy="12" r="5"/>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                  </svg>
                </div>
                <div>
                  <div class="font-medium">Theme</div>
                  <div class="text-sm opacity-60" id="currentThemeLabel">Sunrise</div>
                </div>
              </div>
              <button id="themeToggleBtn" class="text-blue-500 font-medium">Change</button>
            </div>
          </div>
        </div>

        <!-- Data Management -->
        <div>
          <div class="section-header">
            <h2 class="section-title">Data</h2>
          </div>
          <div class="settings-list">
            <button id="exportBtn" class="settings-item w-full">
              <div class="settings-item-left">
                <div class="settings-item-icon bg-green-100">
                  <svg viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                  </svg>
                </div>
                <div class="text-left">
                  <div class="font-medium">Export Data</div>
                  <div class="text-sm opacity-60">Download as JSON</div>
                </div>
              </div>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
            <label class="settings-item cursor-pointer">
              <div class="settings-item-left">
                <div class="settings-item-icon bg-blue-100">
                  <svg viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                  </svg>
                </div>
                <div class="text-left">
                  <div class="font-medium">Import Data</div>
                  <div class="text-sm opacity-60">Load from JSON file</div>
                </div>
              </div>
              <input type="file" id="importInput" accept=".json" class="hidden">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </label>
            <button id="clearAllBtn" class="settings-item w-full">
              <div class="settings-item-left">
                <div class="settings-item-icon bg-red-100">
                  <svg viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                  </svg>
                </div>
                <div class="text-left">
                  <div class="font-medium text-red-600">Clear All Data</div>
                  <div class="text-sm opacity-60">Delete all bookmarks</div>
                </div>
              </div>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- GitHub Sync -->
        <div>
          <div class="section-header">
            <h2 class="section-title">GitHub Sync</h2>
          </div>
          <div class="p-4 space-y-3">
            <input type="text" id="githubOwner" placeholder="Owner / Username" 
                   class="w-full border border-slate-200">
            <input type="text" id="githubRepo" placeholder="Repository name" 
                   class="w-full border border-slate-200">
            <input type="text" id="githubPath" placeholder="Path (e.g. data/bookmarks.json)" 
                   class="w-full border border-slate-200">
            <input type="password" id="githubToken" placeholder="Personal Access Token" 
                   class="w-full border border-slate-200">
            <div class="grid grid-cols-2 gap-3 pt-2">
              <button id="pullGithubBtn" class="py-3 rounded-2xl bg-black/5 font-medium">
                Pull
              </button>
              <button id="pushGithubBtn" class="py-3 rounded-2xl bg-slate-900 text-white font-medium">
                Push
              </button>
            </div>
            <p id="githubStatus" class="text-sm text-center opacity-60">Not synced</p>
          </div>
        </div>

        <!-- About -->
        <div>
          <div class="section-header">
            <h2 class="section-title">About</h2>
          </div>
          <div class="settings-list">
            <div class="settings-item">
              <div class="settings-item-left">
                <div class="settings-item-icon bg-amber-100">
                  <svg viewBox="0 0 24 24" fill="none" stroke="#d97706" stroke-width="2">
                    <path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"/>
                  </svg>
                </div>
                <div>
                  <div class="font-medium">Mani's Bookmark Vault</div>
                  <div class="text-sm opacity-60">Version 2.0</div>
                </div>
              </div>
            </div>
            <button id="installPwaBtn" class="settings-item w-full" disabled>
              <div class="settings-item-left">
                <div class="settings-item-icon bg-cyan-100">
                  <svg viewBox="0 0 24 24" fill="none" stroke="#0891b2" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                  </svg>
                </div>
                <div class="text-left">
                  <div class="font-medium">Install App</div>
                  <div class="text-sm opacity-60">Add to home screen</div>
                </div>
              </div>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Floating Action Button -->
  <button id="fabAdd" class="fab">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
      <path d="M12 5v14M5 12h14"/>
    </svg>
  </button>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav" id="bottomNav">
    <button class="nav-item active" data-nav="home">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
        <polyline points="9 22 9 12 15 12 15 22"/>
      </svg>
      <span>Home</span>
    </button>
    <button class="nav-item" data-nav="search">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="M21 21l-4.35-4.35"/>
      </svg>
      <span>Search</span>
    </button>
    <button class="nav-item" data-nav="clipboard">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/>
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
      </svg>
      <span>Clipboard</span>
    </button>
    <button class="nav-item" data-nav="folders">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
      </svg>
      <span>Folders</span>
    </button>
  </nav>

  <!-- Action Sheet -->
  <div id="actionSheet" class="action-sheet">
    <div class="action-sheet-content">
      <div class="action-sheet-handle"></div>
      <div id="actionSheetItems"></div>
    </div>
  </div>

  <!-- Clipboard Modal -->
  <div id="clipboardSheet" class="action-sheet">
    <div class="action-sheet-content">
      <div class="action-sheet-handle"></div>
      <h3 class="text-lg font-semibold mb-2 px-4">Clipboard Content</h3>
      <div class="clipboard-preview">
        <p id="clipboardPreviewText" class="clipboard-preview-text"></p>
      </div>
      <div class="space-y-1 px-2">
        <button class="action-sheet-item" data-clip-action="bookmark">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"/>
          </svg>
          Save as Bookmark
        </button>
        <button class="action-sheet-item" data-clip-action="text">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
          </svg>
          Save as Text Snippet
        </button>
        <button class="action-sheet-item" data-clip-action="image">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <circle cx="8.5" cy="8.5" r="1.5"/>
            <polyline points="21 15 16 10 5 21"/>
          </svg>
          Save as Image URL
        </button>
        <div class="context-menu-divider"></div>
        <button class="action-sheet-item" data-clip-action="dismiss">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M15 9l-6 6M9 9l6 6"/>
          </svg>
          Dismiss
        </button>
      </div>
    </div>
  </div>

  <!-- Context Menu -->
  <div id="contextMenu" class="context-menu"></div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- Theme Picker Sheet -->
  <div id="themeSheet" class="action-sheet">
    <div class="action-sheet-content">
      <div class="action-sheet-handle"></div>
      <h3 class="text-lg font-semibold mb-4 px-4">Choose Theme</h3>
      <div class="space-y-1 px-2">
        <button class="action-sheet-item" data-theme-select="sunrise">
          <span class="w-6 h-6 rounded-full bg-gradient-to-br from-amber-200 to-orange-300"></span>
          Sunrise
        </button>
        <button class="action-sheet-item" data-theme-select="midnight">
          <span class="w-6 h-6 rounded-full bg-gradient-to-br from-slate-800 to-slate-900"></span>
          Midnight
        </button>
        <button class="action-sheet-item" data-theme-select="neon">
          <span class="w-6 h-6 rounded-full bg-gradient-to-br from-purple-900 to-violet-950"></span>
          Neon
        </button>
        <button class="action-sheet-item" data-theme-select="glass">
          <span class="w-6 h-6 rounded-full bg-gradient-to-br from-blue-100 to-pink-100"></span>
          Glass
        </button>
      </div>
    </div>
  </div>

  <script>
    // ============================================
    // CONSTANTS & STATE
    // ============================================
    const STORAGE_KEY = 'maniBookmarkVault';
    const PLATFORMS = ['All', 'YouTube', 'Article', 'Podcast', 'Tweet', 'Custom'];
    const THEMES = ['sunrise', 'midnight', 'neon', 'glass'];
    const ITEMS_PER_PAGE = 20;

    const state = {
      bookmarks: [],
      theme: 'sunrise',
      filters: { platform: 'All', folder: 'All', search: '' },
      github: { owner: '', repo: '', path: 'data/bookmarks.json', token: '', sha: '' },
      currentTab: 'bookmarks',
      currentView: 'home',
      page: 1,
      editingId: null,
      clipboardText: '',
      lastClipboard: '',
      selectedBookmark: null
    };

    let deferredPrompt = null;
    let touchStartX = 0;
    let touchStartY = 0;
    let pullStartY = 0;
    let isPulling = false;

    // ============================================
    // DOM ELEMENTS
    // ============================================
    const dom = {
      body: document.body,
      homeView: document.getElementById('homeView'),
      settingsView: document.getElementById('settingsView'),
      addModal: document.getElementById('addModal'),
      bookmarkForm: document.getElementById('bookmarkForm'),
      bookmarkList: document.getElementById('bookmarkList'),
      snippetList: document.getElementById('snippetList'),
      imageGrid: document.getElementById('imageGrid'),
      emptyState: document.getElementById('emptyState'),
      searchInput: document.getElementById('searchInput'),
      clearSearchBtn: document.getElementById('clearSearchBtn'),
      platformRail: document.getElementById('platformRail'),
      folderRail: document.getElementById('folderRail'),
      contentTabs: document.getElementById('contentTabs'),
      statsBar: document.getElementById('statsBar'),
      bottomNav: document.getElementById('bottomNav'),
      fabAdd: document.getElementById('fabAdd'),
      actionSheet: document.getElementById('actionSheet'),
      actionSheetItems: document.getElementById('actionSheetItems'),
      clipboardSheet: document.getElementById('clipboardSheet'),
      clipboardPreviewText: document.getElementById('clipboardPreviewText'),
      themeSheet: document.getElementById('themeSheet'),
      contextMenu: document.getElementById('contextMenu'),
      toast: document.getElementById('toast'),
      pullIndicator: document.getElementById('pullIndicator'),
      loadMoreContainer: document.getElementById('loadMoreContainer'),
      loadMoreBtn: document.getElementById('loadMoreBtn'),
      bookmarkCountLabel: document.getElementById('bookmarkCountLabel'),
      modalTitle: document.getElementById('modalTitle'),
      urlInput: document.getElementById('urlInput'),
      imageFileInput: document.getElementById('imageFileInput'),
      imagePreview: document.getElementById('imagePreview'),
      removeImageBtn: document.getElementById('removeImageBtn'),
      folderDatalist: document.getElementById('folderDatalist'),
      // Stats
      statTotal: document.getElementById('statTotal'),
      statToday: document.getElementById('statToday'),
      statWeek: document.getElementById('statWeek'),
      statFolders: document.getElementById('statFolders'),
      // Settings
      headerSettingsBtn: document.getElementById('headerSettingsBtn'),
      backFromSettings: document.getElementById('backFromSettings'),
      themeToggleBtn: document.getElementById('themeToggleBtn'),
      currentThemeLabel: document.getElementById('currentThemeLabel'),
      exportBtn: document.getElementById('exportBtn'),
      importInput: document.getElementById('importInput'),
      clearAllBtn: document.getElementById('clearAllBtn'),
      installPwaBtn: document.getElementById('installPwaBtn'),
      // GitHub
      githubOwner: document.getElementById('githubOwner'),
      githubRepo: document.getElementById('githubRepo'),
      githubPath: document.getElementById('githubPath'),
      githubToken: document.getElementById('githubToken'),
      pullGithubBtn: document.getElementById('pullGithubBtn'),
      pushGithubBtn: document.getElementById('pushGithubBtn'),
      githubStatus: document.getElementById('githubStatus'),
      // Modal
      cancelAddBtn: document.getElementById('cancelAddBtn'),
      saveBookmarkBtn: document.getElementById('saveBookmarkBtn')
    };

    // ============================================
    // INITIALIZATION
    // ============================================
    document.addEventListener('DOMContentLoaded', init);

    function init() {
      loadState();
      applyTheme();
      bindEvents();
      renderAll();
      setupPWA();
      checkClipboard();
      handleShareTarget();
      checkReminders();
    }

    function loadState() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          const parsed = JSON.parse(saved);
          state.bookmarks = parsed.bookmarks || [];
          state.theme = parsed.theme || 'sunrise';
          state.github = { ...state.github, ...(parsed.github || {}) };
        }
      } catch (e) {
        console.error('Failed to load state:', e);
      }
      
      // Hydrate GitHub fields
      dom.githubOwner.value = state.github.owner;
      dom.githubRepo.value = state.github.repo;
      dom.githubPath.value = state.github.path;
      dom.githubToken.value = state.github.token;
    }

    function saveState() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify({
          bookmarks: state.bookmarks,
          theme: state.theme,
          github: state.github
        }));
      } catch (e) {
        console.error('Failed to save state:', e);
      }
    }

    // ============================================
    // EVENT BINDINGS
    // ============================================
    function bindEvents() {
      // Search
      dom.searchInput.addEventListener('input', handleSearch);
      dom.searchInput.addEventListener('focus', () => switchNav('search'));
      dom.clearSearchBtn.addEventListener('click', clearSearch);

      // Navigation
      dom.bottomNav.querySelectorAll('.nav-item').forEach(btn => {
        btn.addEventListener('click', () => handleNavClick(btn.dataset.nav));
      });

      // FAB
      dom.fabAdd.addEventListener('click', openAddModal);

      // Modal
      dom.cancelAddBtn.addEventListener('click', closeAddModal);
      dom.saveBookmarkBtn.addEventListener('click', handleSaveBookmark);
      dom.addModal.addEventListener('click', (e) => {
        if (e.target === dom.addModal) closeAddModal();
      });

      // Image upload
      dom.imageFileInput.addEventListener('change', handleImageUpload);
      dom.removeImageBtn.addEventListener('click', removeImage);

      // Content Tabs
      dom.contentTabs.querySelectorAll('.tab-item').forEach(tab => {
        tab.addEventListener('click', () => switchTab(tab.dataset.tab));
      });

      // Settings
      dom.headerSettingsBtn.addEventListener('click', () => switchView('settings'));
      dom.backFromSettings.addEventListener('click', () => switchView('home'));
      dom.themeToggleBtn.addEventListener('click', () => showSheet('themeSheet'));
      dom.exportBtn.addEventListener('click', exportData);
      dom.importInput.addEventListener('change', importData);
      dom.clearAllBtn.addEventListener('click', clearAllData);
      dom.installPwaBtn.addEventListener('click', installPWA);

      // GitHub
      dom.githubOwner.addEventListener('change', (e) => updateGithub('owner', e.target.value));
      dom.githubRepo.addEventListener('change', (e) => updateGithub('repo', e.target.value));
      dom.githubPath.addEventListener('change', (e) => updateGithub('path', e.target.value));
      dom.githubToken.addEventListener('change', (e) => updateGithub('token', e.target.value));
      dom.pullGithubBtn.addEventListener('click', pullFromGithub);
      dom.pushGithubBtn.addEventListener('click', pushToGithub);

      // Theme selection
      dom.themeSheet.querySelectorAll('[data-theme-select]').forEach(btn => {
        btn.addEventListener('click', () => {
          setTheme(btn.dataset.themeSelect);
          hideSheet('themeSheet');
        });
      });

      // Clipboard actions
      dom.clipboardSheet.querySelectorAll('[data-clip-action]').forEach(btn => {
        btn.addEventListener('click', () => handleClipboardAction(btn.dataset.clipAction));
      });

      // Action sheet dismiss
      [dom.actionSheet, dom.clipboardSheet, dom.themeSheet].forEach(sheet => {
        sheet.addEventListener('click', (e) => {
          if (e.target === sheet) hideAllSheets();
        });
      });

      // Load more
      dom.loadMoreBtn.addEventListener('click', loadMore);

      // Pull to refresh
      document.addEventListener('touchstart', handleTouchStart, { passive: true });
      document.addEventListener('touchmove', handleTouchMove, { passive: false });
      document.addEventListener('touchend', handleTouchEnd);

      // Context menu dismiss
      document.addEventListener('click', () => hideContextMenu());
      document.addEventListener('touchstart', () => hideContextMenu());

      // Visibility change (clipboard check)
      document.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
          setTimeout(checkClipboard, 300);
        }
      });

      // Window focus
      window.addEventListener('focus', () => setTimeout(checkClipboard, 300));

      // PWA install prompt
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        dom.installPwaBtn.disabled = false;
      });
    }

    // ============================================
    // NAVIGATION & VIEWS
    // ============================================
    function switchView(view) {
      state.currentView = view;
      
      document.querySelectorAll('.view-section').forEach(v => {
        v.classList.remove('active');
      });
      
      if (view === 'home') {
        dom.homeView.classList.add('active');
        dom.bottomNav.style.display = 'flex';
        dom.fabAdd.style.display = 'flex';
      } else if (view === 'settings') {
        dom.settingsView.classList.add('active');
        dom.bottomNav.style.display = 'none';
        dom.fabAdd.style.display = 'none';
      }
    }

    function handleNavClick(nav) {
      switchNav(nav);
      
      if (nav === 'home') {
        state.filters = { platform: 'All', folder: 'All', search: '' };
        dom.searchInput.value = '';
        state.page = 1;
        renderAll();
      } else if (nav === 'search') {
        dom.searchInput.focus();
      } else if (nav === 'clipboard') {
        checkClipboard(true);
      } else if (nav === 'folders') {
        showFolderSheet();
      }
    }

    function switchNav(nav) {
      dom.bottomNav.querySelectorAll('.nav-item').forEach(item => {
        item.classList.toggle('active', item.dataset.nav === nav);
      });
    }

    function switchTab(tab) {
      state.currentTab = tab;
      
      dom.contentTabs.querySelectorAll('.tab-item').forEach(t => {
        t.classList.toggle('active', t.dataset.tab === tab);
      });
      
      dom.bookmarkList.classList.toggle('hidden', tab !== 'bookmarks');
      dom.snippetList.classList.toggle('hidden', tab !== 'snippets');
      dom.imageGrid.classList.toggle('hidden', tab !== 'images');
      
      renderCurrentTab();
    }

    // ============================================
    // RENDERING
    // ============================================
    function renderAll() {
      renderStats();
      renderPlatformRail();
      renderFolderRail();
      renderCurrentTab();
      updateFolderDatalist();
    }

    function renderStats() {
      const now = new Date();
      const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const weekStart = new Date(todayStart);
      weekStart.setDate(weekStart.getDate() - 7);
      
      const total = state.bookmarks.length;
      const today = state.bookmarks.filter(b => new Date(b.createdAt) >= todayStart).length;
      const week = state.bookmarks.filter(b => new Date(b.createdAt) >= weekStart).length;
      const folders = new Set(state.bookmarks.map(b => b.folder || 'Default')).size;
      
      dom.statTotal.textContent = total;
      dom.statToday.textContent = today;
      dom.statWeek.textContent = week;
      dom.statFolders.
